================================================================================
                    BRIE IT AGENT - STEP FUNCTIONS DOCUMENTATION
================================================================================

SYSTEM OVERVIEW:
- Automated email processing for brieitagent@ever.ag
- AWS Lambda + Claude AI + Microsoft Graph API
- Full Image Analysis with Claude Vision
- 15 detection steps covering 95-98% of IT support cases

PROCESSING FLOW:
1. Retrieve unread emails
2. Analyze image attachments (Claude Vision)
3. Run detection steps in priority order
4. Generate AI responses or route to helpdesk

================================================================================
                              DETECTION STEPS
================================================================================

STEP -1: AUTOMATED SYSTEM EMAILS
├── Purpose: Prevent bot loops
├── Keywords: "bot troubleshooting", "automated response", "system notification"
└── Action: IGNORE (no response, no deletion)

STEP -1.0: EVER.AG WELCOME EMAILS  
├── Purpose: Handle portal migration
├── Detection: Subject "[Action Required] Welcome to Ever.Ag"
├── Response: "This is a legitimate email related to a portal move..."
└── Action: SEND RESPONSE + DELETE

STEP -0.95: NEW EMPLOYEE WELCOME
├── Purpose: Route onboarding to helpdesk
├── Keywords: "welcome to ever.ag", "new employee", "first time login"
└── Action: DELETE + SEND TO HELPDESK

STEP -0.9: DISTRIBUTION LIST INQUIRIES
├── Purpose: Route group membership requests
├── Keywords: "who receives emails", "distribution list", "group members"
└── Action: DELETE + SEND TO HELPDESK

STEP -0.8: MICROSOFT ACCESS DENIED
├── Purpose: Route auth/permission issues
├── Detection: Microsoft keywords + "cannot access this right now"
└── Action: DELETE + SEND TO HELPDESK

STEP -0.7: DAILY ADMIN TASKS
├── Purpose: Remove routine noise
├── Keywords: "daily admin task"
└── Action: DELETE ONLY

STEP -0.64: ONBOARDING/OFFBOARDING
├── Purpose: Route employee lifecycle
├── Detection: Subject contains "onboarding" or "offboarding"
└── Action: DELETE + SEND TO HELPDESK

STEP -0.63: EMAIL FORWARDING REQUESTS
├── Purpose: Route mailbox configuration
├── Keywords: "enable email address", "route email", "forward email"
└── Action: DELETE + SEND TO HELPDESK

STEP -0.62: INTERNATIONAL TRAVEL
├── Purpose: Route security/compliance travel
├── Keywords: "planned travel" + international locations
└── Action: DELETE + SEND TO HELPDESK

STEP -0.6: ACCOUNT CREATION
├── Purpose: Route user provisioning
├── Keywords: "create account", "new account", "add user", "provision"
└── Action: DELETE + SEND TO HELPDESK

STEP -0.5: SECURITY ALERTS
├── Purpose: Forward critical notifications
├── Keywords: "user at risk detected"
└── Action: FORWARD TO SLACK + DELETE

STEP 0: WINDOWS UPDATE ISSUES
├── Purpose: Company patch guidance
├── Keywords: "windows update", "patch tuesday", "update fail"
├── Response: Company-managed patch explanation
└── Action: SEND RESPONSE + DELETE

STEP 0A: HARDWARE REQUESTS
├── Purpose: Route equipment requests
├── Keywords: "replace laptop", "new laptop", "hardware request"
└── Action: DELETE + SEND TO HELPDESK

STEP 0B: PAID SOFTWARE REQUESTS
├── Purpose: Handle licensing with cost approval
├── Keywords: "visio", "adobe pro", "acrobat pro", "copilot"
├── Response: Cost approval message with pricing
└── Action: SEND RESPONSE + DELETE

STEP 0C: ACCESS REQUESTS (SMART)
├── Purpose: Educate or route based on specificity
├── VAGUE REQUESTS:
│   ├── Detection: General access keywords without details
│   ├── Response: Detailed questionnaire for specifics
│   └── Action: SEND QUESTIONS + DELETE
└── SPECIFIC REQUESTS:
    ├── Detection: Access keywords + specific systems/context
    └── Action: DELETE + SEND TO HELPDESK

STEP 1: CONNECTION SLOWNESS
├── Purpose: Speed test instructions
├── Detection: BOTH slowness AND connection keywords required
├── Response: 10-step speed test with screenshot requirements
└── Action: SEND RESPONSE + DELETE

STEP 2: WIKI SEARCH
├── Purpose: Find existing Confluence solutions
├── Search: IT space with "foritchatbot" label
└── Action: RETURN SOLUTION if found

STEP 3: TROUBLESHOOTING QUALITY CHECK
├── Purpose: Assess user-provided details
├── Analysis: Count diagnostic attempts and troubleshooting indicators
└── Decision: Determine if more info needed

STEP 4: CLAUDE AI RESPONSE GENERATION
├── Purpose: Generate contextual IT support
├── Features: Context-specific questions + safe troubleshooting
├── Response: Professional IT support format
└── Action: SEND AI RESPONSE + DELETE

================================================================================
                            IMAGE ANALYSIS SYSTEM
================================================================================

CLAUDE VISION (PRIMARY):
├── Coverage: 95-98% of screenshot cases
├── Capabilities: Error extraction, app ID, UI problems, context
├── Cost: ~$3.00 per 1,000 images
└── Processing: 10-15 seconds per image

AWS TEXTRACT (FALLBACK):
├── Coverage: 80% of text-based screenshots
├── Capabilities: Text extraction only
├── Cost: ~$1.50 per 1,000 images
└── Processing: 1-2 seconds per image

SUPPORTED FORMATS:
└── PNG, JPG, JPEG, GIF, BMP + Microsoft Graph octet-stream

================================================================================
                              RESPONSE TEMPLATES
================================================================================

STANDARD IT RESPONSE:
┌─────────────────────────────────────────────────────────────────────────────┐
│ Hello,                                                                      │
│                                                                             │
│ Thank you for contacting IT support. To help us resolve your issue         │
│ quickly, please provide the following information and try these             │
│ troubleshooting steps:                                                      │
│                                                                             │
│ • [Context-specific diagnostic question 1]                                 │
│ • [Context-specific diagnostic question 2]                                 │
│ ◦ [Safe troubleshooting step 1]                                           │
│ ◦ [Safe troubleshooting step 2]                                           │
│                                                                             │
│ The more specific details you provide, the faster we can help resolve      │
│ your issue.                                                                 │
│                                                                             │
│ ---                                                                         │
│ This message was sent by our 🤖 Brie IT Agent                              │
└─────────────────────────────────────────────────────────────────────────────┘

================================================================================
                              SYSTEM STATISTICS
================================================================================

COVERAGE: 95-98% of IT support scenarios
PROCESSING TIME: 1-15 seconds (depending on images)
DETECTION RULES: 15 automated steps
RESPONSE ACCURACY: Context-aware with Claude AI
COST EFFICIENCY: Significant reduction in human workload

TECHNICAL SPECS:
├── Platform: AWS Lambda Python 3.12
├── Memory: 256 MB
├── Timeout: 300 seconds
├── Trigger: Every minute
└── Integrations: Graph API, Bedrock, Textract, Slack

================================================================================
                                 WORKFLOW DIAGRAM
================================================================================

Email Received → Image Analysis → Detection Steps → Action Taken
     ↓               ↓                ↓              ↓
┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐
│ Unread      │ │ Claude      │ │ Priority    │ │ Response/   │
│ Email       │→│ Vision      │→│ Detection   │→│ Route/      │
│ Retrieved   │ │ Analysis    │ │ Rules       │ │ Delete      │
└─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘
                      ↓              ↓              ↓
                ┌─────────────┐ ┌─────────────┐ ┌─────────────┐
                │ Text +      │ │ Match       │ │ User Gets   │
                │ Context     │ │ Keywords/   │ │ Appropriate │
                │ Enhanced    │ │ Patterns    │ │ Response    │
                └─────────────┘ └─────────────┘ └─────────────┘

================================================================================
Generated: September 23, 2025
System Version: Full Image Analysis with Claude Vision
Total Detection Steps: 15
Coverage: 95-98% of IT Support Cases
================================================================================
